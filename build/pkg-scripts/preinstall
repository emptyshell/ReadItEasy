#!/bin/sh -e

if [[ -z $(command -v pwsh) ]];
then
    #/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"  > ~/installer.log

    cd /tmp
    curl -L -O https://github.com/PowerShell/PowerShell/releases/download/v7.1.3/powershell-7.1.3-osx-x64.pkg

    # sudo installer -pkg powershell-*.pkg -target /Applications
    open /tmp/powershell-*.pkg
fi

if [[ $(pwsh -c "Get-Module -listavailable | select-string -pattern 'MicrosoftTeams'") != "MicrosoftTeams" ]];
then
    pwsh -c "Install-Module MicrosoftTeams -Force"
fi